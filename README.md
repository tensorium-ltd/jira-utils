# Sprint Management & JIRA Reporting Suite

A comprehensive Node.js toolkit for managing sprint planning, tracking story points, and generating detailed reports from both Excel plans and JIRA Cloud.

## Table of Contents

- [Overview](#overview)
- [Setup](#setup)
- [Configuration](#configuration)
- [Excel Plan Structure](#excel-plan-structure)
- [Scripts](#scripts)
  - [Sprint Planning Scripts](#sprint-planning-scripts)
  - [JIRA Integration Scripts](#jira-integration-scripts)
  - [Daily Reporting Scripts](#daily-reporting-scripts)
  - [Team Analysis Scripts](#team-analysis-scripts)
  - [Quality Assurance Scripts](#quality-assurance-scripts)
  - [Defect Management Scripts](#defect-management-scripts)
  - [Status Tracking Scripts](#status-tracking-scripts)
- [Output Files](#output-files)
- [Troubleshooting](#troubleshooting)

---

## Overview

This suite provides end-to-end sprint management capabilities:
- **Sprint Planning**: Generate sprint sheets with S-curve story point distribution
- **Progress Tracking**: Monitor daily velocity, cumulative progress, and burndown
- **JIRA Integration**: Pull live data on completed work, in-progress items, and team allocation
- **Team Analytics**: Analyze assignee workload, team performance, and capacity
- **Quality Monitoring**: Track QA backlog and identify stale issues
- **Defect Management**: Import UAT defects from CSV directly into JIRA
- **Status Tracking**: **NEW** - Snapshot story point distribution across workflow stages
- **PDF Reports**: Professional PDF reports for executive stakeholders

---

## Setup

### Prerequisites
- Node.js (v14 or higher)
- npm or yarn
- JIRA Cloud account with API access
- Excel plan file (`.xlsx` format)

### Installation

```bash
npm install
```

### Dependencies
- `exceljs` - Excel file manipulation
- `pdfkit` - PDF generation
- `axios` - HTTP client for JIRA API
- `xlsx` - Excel file parsing
- `csv-parse` - **NEW**: CSV file parsing for defect imports

---

## Configuration

### Environment Variables

All JIRA integration scripts require these environment variables:

```bash
export JIRA_EMAIL="your.email@company.com"
export JIRA_API_TOKEN="your_jira_api_token"
export JIRA_BASE_URL="https://your-company.atlassian.net"
```

#### Obtaining a JIRA API Token

1. Log in to [https://id.atlassian.com/manage-profile/security/api-tokens](https://id.atlassian.com/manage-profile/security/api-tokens)
2. Click "Create API token"
3. Give it a descriptive name (e.g., "Sprint Reports")
4. Copy the token (you won't be able to see it again)
5. Set it as the `JIRA_API_TOKEN` environment variable

### Project Configuration

Update these constants in the respective scripts as needed:

**JIRA Settings** (in all JIRA scripts):
```javascript
const PROJECT_KEY = 'VER10';           // Your JIRA project key
const CURRENT_SPRINT = 'NH Sprint 31'; // Current sprint name
```

**Excel File Location**:
```javascript
const WORKBOOK_PATH = './data/NH Story Point Plan.xlsx';
```

---

## Excel Plan Structure

The main planning Excel file (`data/NH Story Point Plan.xlsx`) must have the following structure:

### Main Sheet: "Full-Delivery"

#### Required Rows (Column A):
- **Sprint Information Rows**:
  - `Sprint Number` - e.g., 30, 31, 32
  - `Sprint Start Date` - Working day start date
  - `Sprint End Date` - Working day end date
  - `Total Working Days Per Sprint` - Usually 10
  - `Total Committed Story Points Per Sprint` - Target points
  - `Story Points Delivered` - Actual delivered points (updated daily)
  - `BUGS` - Bug fix story points
  - `STABILIZATION` - Stabilization work points
  - `DELIVERED TODAY` - Points completed today (in Column B)
  - `TOTAL PROJECT REMAINING STORY POINTS` - Overall project remaining work

- **Epic Rows** (starting after header rows):
  - Column A: Epic name
  - Columns for each sprint: Story points allocated
  - Row named `TOTALS`: Formula summing all epics
  - Row marker: `IGNORE BELOW` - Anything below this is excluded

#### Special Markers:
- `IGNORE BELOW` - Place this in Column A to mark the end of epic data

### Progress Sheet

Auto-generated by scripts with the following structure:
- **Row 1**: Date headers (working days only)
- **Row 2**: Target Velocity (S-curve distributed)
- **Row 3**: Actual Velocity (daily completed points)
- **Row 4**: Cumulative Committed
- **Row 5**: Cumulative Actual
- **Row 6**: Variance (Actual - Committed)
- **Row 7**: Burndown (Remaining work)

### Designs Sheet (Optional)

For design progress tracking:
- **Column A**: Epic names
- **Column B**: Percentage complete (0-100)

### Individual Sprint Sheets

Auto-generated by `generate-sprint-sheets.js`:
- Sprint metadata (dates, working days, totals)
- Epic-by-epic breakdown
- Daily story point allocation (with S-curve distribution)
- Story Points Delivered row
- Summary calculations

---

## Scripts

### Sprint Planning Scripts

#### 1. `generate-sprint-sheets.js`

Generates individual sprint sheets from the main Excel plan.

**Features**:
- Reads sprint configuration from "Full-Delivery" sheet
- Distributes story points using S-curve profile (slow start, peak middle, slow end)
- Creates one sheet per sprint with detailed breakdown
- Excludes epics with 0 points for that sprint
- Respects "IGNORE BELOW" marker
- Populates Progress sheet with S-curve target velocity

**Usage**:
```bash
npm run generate-sheets
```

**S-Curve Distribution**:
- Days 1-2: ~15% of total (slow start)
- Days 3-7: ~40% of total (peak productivity)
- Days 8-10: ~15% of total (slow finish)

**Output**: Updates `data/NH Story Point Plan.xlsx` with:
- Individual sprint sheets (e.g., "Sprint 30", "Sprint 31")
- Updated "Progress" sheet with target velocities

---

#### 2. `generate-sprint-report.js`

Generates comprehensive PDF reports for sprints.

**Features**:
- **Page 1**: Simplified sprint status (committed vs. delivered, velocity metrics)
- **Page 2**: Detailed executive summary with insights and burndown
- **Design Pages**: Epic-level design progress (if Designs sheet exists)
- Charts: Horizontal stacked bar charts showing work breakdown (Features/Bugs/Stabilization)
- Project-level metrics: Overall progress, remaining work, required velocity
- Release-level metrics: Progress toward specific release milestones
- Visual indicators: Red/green status markers for at-risk metrics

**Usage**:
```bash
npm run generate-report <sprint-number>
```

**Example**:
```bash
npm run generate-report 31
```

**Output**: `reports/sprint-<number>-report.pdf`

---

### JIRA Integration Scripts

All JIRA scripts require environment variables to be set.

#### 3. `get-jira-completed-points.js`

Fetches completed story points from JIRA for a date range.

**Features**:
- Queries issues completed in a date range
- Uses "Status change to Done" date (transitions to 'READY FOR RELEASE' or 'CLOSED')
- Filters to Story and Bug issue types only
- Defaults missing story points to 2
- Provides breakdown by issue type

**Usage**:
```bash
npm run jira-points <start-date> <end-date>
```

**Example**:
```bash
npm run jira-points 2025-11-09 2025-11-10
```

**Output**: `reports/completed-points-<start>-to-<end>.json`

**Output Format**:
```json
{
  "dateRange": { "start": "2025-11-09", "end": "2025-11-10" },
  "summary": {
    "totalIssues": 15,
    "totalStoryPoints": 32,
    "byType": {
      "Story": { "count": 12, "storyPoints": 26 },
      "Bug": { "count": 3, "storyPoints": 6 }
    }
  },
  "issues": [...]
}
```

---

#### 4. `generate-sprint-estimates.js`

Gets total story points allocated to specific sprints in JIRA.

**Features**:
- Queries multiple sprints (NH Sprint 31 through NH Sprint 36)
- Counts Epic, Story, and Bug issue types only
- Defaults missing story points to 2 for Stories/Bugs
- Uses two-step API approach to handle pagination (fetch keys, then details)

**Usage**:
```bash
npm run sprint-estimates
```

**Output**: `reports/sprint-estimates-<date>.json`

**Output Format**:
```json
{
  "sprints": {
    "NH Sprint 31": {
      "totalStoryPoints": 250,
      "totalIssues": 125,
      "breakdown": {
        "Epic": { "count": 15, "storyPoints": 0 },
        "Story": { "count": 95, "storyPoints": 220 },
        "Bug": { "count": 15, "storyPoints": 30 }
      }
    }
  }
}
```

---

#### 5. `generate-jira-into-QA.js`

Lists issues moved to "In QA" status today.

**Features**:
- Analyzes changelog for status transitions today
- Includes issue details (key, summary, type, priority, points)
- Filters to Story and Bug types
- Defaults missing points to 2

**Usage**:
```bash
npm run jira-qa
```

**Output**: `reports/moved-to-qa-<date>.json`

---

#### 6. `generate-jira-into-dev.js`

Lists issues moved to "In Dev" status today.

**Features**:
- Analyzes changelog for status transitions today
- Includes issue details (key, summary, type, priority, points)
- Filters to Story and Bug types
- Defaults missing points to 2

**Usage**:
```bash
npm run jira-dev
```

**Output**: `reports/moved-to-dev-<date>.json`

---

### Daily Reporting Scripts

#### 7. `generate-work-done-today-report.js`

Combines completed work, QA entries, and dev starts into a single daily report with sprint context.

**Features**:
- Aggregates data from completed, in-QA, and in-dev scripts
- Shows total story points worked on across all activities
- **NEW**: Includes sprint-to-date totals (completed issues and points)
- Optimized JQL queries (only fetches issues updated today)
- Detailed breakdown by activity type
- Provides both today's velocity and cumulative sprint progress

**Usage**:
```bash
npm run work-today
```

**Output**: `reports/work-done-today-<date>.json`

**Output Format**:
```json
{
  "date": "2025-11-10",
  "sprint": "NH Sprint 31",
  "summary": {
    "today": {
      "totalIssues": 9,
      "totalStoryPoints": 20,
      "completed": { "issues": 8, "storyPoints": 18 },
      "movedToQA": { "issues": 5, "storyPoints": 10 },
      "movedToDev": { "issues": 4, "storyPoints": 8 }
    },
    "sprintTotal": {
      "completedIssues": 32,
      "completedStoryPoints": 68,
      "breakdown": { ... }
    }
  },
  "details": { ... }
}
```

---

#### 8. `generate-work-today-pdf.js`

Generates PDF report from the daily work JSON.

**Features**:
- Professional multi-page PDF layout
- Summary metrics at the top
- Bar charts for visual analysis
- Detailed issue lists by activity type

**Usage**:
```bash
npm run work-today-pdf <date>
```

**Example**:
```bash
npm run work-today-pdf 2025-11-10
```

**Output**: `reports/work-done-today-<date>.pdf`

---

### Team Analysis Scripts

#### 9. `generate-assignee-report.js`

Analyzes work done today and current sprint workload by assignee and team.

**Features**:
- Today's activity breakdown by assignee
- Current sprint workload (active vs. completed) by assignee
- Team-level allocation and completion tracking
- Uses custom JIRA field "Team Name" (`customfield_12700`)
- Comprehensive issue counting

**Usage**:
```bash
npm run assignee-report
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31'; // Update this in the script
```

**Output**: `reports/assignee-report-sprint-<number>.json`

**Output Format**:
```json
{
  "sprint": "NH Sprint 31",
  "todayActivity": {
    "completed": { ... },
    "movedToQA": { ... },
    "movedToDev": { ... }
  },
  "sprintWorkload": {
    "byAssignee": { ... },
    "byTeam": {
      "Team 1": {
        "totalIssues": 50,
        "totalPoints": 100,
        "completedIssues": 25,
        "completedPoints": 50,
        "activeIssues": 20,
        "activePoints": 40,
        "percentComplete": 50
      }
    }
  }
}
```

---

#### 10. `generate-assignee-pdf.js`

Generates PDF report from assignee analysis.

**Features**:
- **Page 1**: Team allocation and progress (total, completed, active)
- **Page 2**: Individual assignee workload details
- Bar charts for visual analysis
- Condensed formatting to fit all data

**Usage**:
```bash
npm run assignee-pdf <sprint-number>
```

**Example**:
```bash
npm run assignee-pdf 31
```

**Output**: `reports/assignee-report-sprint-<number>.pdf`

---

#### 11. `generate-assignee-allocation-report.js`

Historical performance analysis across multiple sprints.

**Features**:
- Queries multiple sprints (configurable range)
- Per-assignee allocation vs. completion
- Aggregate totals across all sprints
- Detailed breakdown by sprint and assignee

**Usage**:
```bash
npm run assignee-allocation
```

**Configuration** (edit script):
```javascript
const SPRINTS = ['NH Sprint 28', 'NH Sprint 29', 'NH Sprint 30', 'NH Sprint 31'];
```

**Output**: `reports/assignee-allocation-<date>.json`

**Console Output**: Summary table showing:
- Issues allocated per assignee per sprint
- Story points allocated per assignee per sprint
- Totals across all sprints

---

#### 12. `generate-dev-review-by-assignee.js`

**NEW**: Shows current sprint tickets in "In Dev" and "In Review/Ready for Review" grouped by status and assignee.

**Features**:
- Focuses on active development work (In Dev and In Review/Ready for Review)
- Groups first by status, then by assignee within each status
- Shows story point totals per assignee in each status
- Case-insensitive status matching
- Defaults missing points to 2 for Stories/Bugs
- Provides complete sprint activity snapshot for standups

**Usage**:
```bash
npm run dev-review
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31'; // Update this in the script
const TARGET_STATUSES = ['In Dev', 'In Review', 'Ready for Review', 'READY FOR REVIEW'];
```

**Output**: `reports/dev-review-by-assignee.json`

**Console Output Example**:
```
============================================================
üíª IN DEV
============================================================
   Total: 11 issues, 20 points

üë§ Sushil Shinde - 1 issues (5 pts)
   - VER10-8501: Epic 9- Fallback Mech... (5 pts)

üë§ Yash Dangi - 1 issues (3 pts)
   - VER10-9139: Dashboard - Displaying... (3 pts)
...

============================================================
üîç IN REVIEW / READY FOR REVIEW
============================================================
   Total: 17 issues, 32 points

üë§ Yash Dangi - 5 issues (11 pts)
   - VER10-9075: Regression : An invalid... (1 pts)
   - VER10-8641: Validating Custom Field... (2 pts)
...
```

**Output Format**:
```json
{
  "sprint": "NH Sprint 31",
  "summary": {
    "totalIssues": 28,
    "totalPoints": 52,
    "inDev": { "issues": 11, "points": 20 },
    "inReview": { "issues": 17, "points": 32 }
  },
  "byStatus": {
    "inDev": [
      {
        "name": "Sushil Shinde",
        "issues": [...],
        "points": 5
      }
    ],
    "inReview": [...]
  },
  "byAssignee": { ... }
}
```

---

### Quality Assurance Scripts

#### 13. `generate-issues-currently-in-qa.js`

Lists all issues currently in QA for the current sprint.

**Features**:
- Shows all Story and Bug issues in "In QA" status
- Includes story points (defaults to 2 if missing)
- Groups by assignee
- Shows issue keys, types, and summaries

**Usage**:
```bash
npm run issues-in-qa
```

**Output**: `reports/issues-in-qa-sprint-<number>.json`

**Console Output Example**:
```
üìä Issues Currently in QA - Sprint 31

### Summary:
6 issues | 10 story points

### All Issues:
1. VER10-8503 - Story - 3 pts - Rachita Kanchari
2. VER10-8484 - Story - 3 pts - bhavesh budhrani
...

### By Assignee:
- Rachita Kanchari: 1 issue (3 pts)
- bhavesh budhrani: 1 issue (3 pts)
...
```

---

#### 14. `generate-time-in-status.js`

Identifies stale issues (no status change for 24+ hours).

**Features**:
- Analyzes changelog to determine last status change
- Sorts by longest time in status (most critical first)
- Excludes completed issues
- Groups by status and assignee
- Highlights workflow bottlenecks

**Usage**:
```bash
npm run time-in-status
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31';
const STALE_THRESHOLD_HOURS = 24;
```

**Output**: `reports/time-in-status-sprint-<number>.json`

**Console Output**:
- Total active issues vs. stale issues
- Top stale issues sorted by duration
- Breakdown by status (identifies bottlenecks)
- Breakdown by assignee (identifies blockers)

**Example Critical Findings**:
```
1. VER10-7735 - In Dev
   Time in Status: 112 days 20 hours
   Assignee: Vijay Mishra
   Type: Bug | Priority: P2 - High | Points: 1
```

---

### Defect Management Scripts

#### 15. `nh-defect-upload.js`

**NEW**: Imports UAT defects from CSV into JIRA as bugs under an Epic.

**Features**:
- Reads CSV file (`data/CCET Release 1 C UAT Defect Log.csv`)
- Creates bugs in JIRA linked to Epic VER10-8245
- Duplicate detection (searches by summary to avoid re-creating bugs)
- Skips test example rows automatically
- Auto-assigns all bugs to Caroline Wallen
- Sets fixVersion to "Release 1C"
- Priority mapping (P1‚ÜíP1 - Critical, P2‚ÜíP2 - High, etc.)
- Formatted description with all CSV fields
- UTF-8 BOM handling for CSV files

**Usage**:

**Dry-Run Mode** (Preview without creating bugs):
```bash
npm run nh-defect-upload -- --dry-run
```

**Create Bugs**:
```bash
npm run nh-defect-upload
```

**Configuration**:
```javascript
const EPIC_KEY = 'VER10-8245';                    // Epic to link bugs to
const CSV_FILE_PATH = './data/CCET Release 1 C UAT Defect Log.csv';
```

**CSV Structure Required**:
- **Defect Name**: Used as JIRA Summary (also for duplicate checking)
- **Severity / Priority**: Mapped to JIRA Priority (P1, P2, P3, P4)
- **All other columns**: Formatted into JIRA Description

**Console Output Example**:
```
üöÄ NH UAT Defect Upload to JIRA
============================================================

üîç Discovering required fields...
   ‚úì Found assignee: Caroline Wallen
   ‚úì Found fixVersion: Release 1C
   ‚úì Found Epic Link field: customfield_11151

üìÑ Reading CSV file...
   ‚úì Found 2 rows in CSV

üìù Processing defects...

‚è≠Ô∏è  Skipping test example: Defect 01 - TEST EXAMPLE - ...

üîç Processing: UAT-PPP-003 - Create Project Button is greyed out
   ‚úÖ Created bug: VER10-9210

============================================================
üìä SUMMARY:
   Total Defects Processed: 2
   ‚úÖ Created: 1
   ‚è≠Ô∏è  Skipped: 1 (1 test example, 0 duplicates)
   ‚ùå Errors: 0

Created Bugs:
   - VER10-9210: UAT-PPP-003 - Create Project Button is greyed out
```

**Dry-Run Feature**:
- Use `--dry-run` flag to preview what will be created without making changes
- Shows exactly what bugs would be created with all field values
- Validates CSV data, checks for duplicates, and maps priorities
- Perfect for verifying data before bulk upload
- No JIRA bugs are created in dry-run mode

**Duplicate Detection**:
- Searches JIRA by summary text before creating
- If found, logs the existing issue key and skips creation
- Prevents duplicate bug entries from repeated script runs

**CSV Example**:
```csv
Defect Name,Severity / Priority,Module / Area,Defect Description,...
"UAT-001 - Login fails","P1","Authentication","Users cannot log in",...
```

---

### Status Tracking Scripts

#### 16. `generate-points-by-status.js`

**NEW**: Provides a snapshot of story point distribution across workflow statuses for the current sprint.

**Features**:
- Shows story points in each workflow stage: In Dev, In Review, In QA, Completed
- Includes percentage breakdown of total points per status
- Lists all issues grouped by status with full details
- Defaults missing points to 2 for Stories/Bugs
- Identifies workflow bottlenecks at a glance
- Perfect for sprint health checks and stand-ups

**Usage**:
```bash
npm run points-by-status
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31'; // Update this in the script
```

**Output**: `reports/points-by-status.json`

**Console Output Example**:
```
============================================================
üìä STORY POINTS BY STATUS SNAPSHOT
   Sprint: NH Sprint 31
   Project: VER10
   Date: 2025-11-11
============================================================

üìà SUMMARY BY STATUS:

   In Dev:
      Issues: 11
      Story Points: 20 (15.2%)

   In Review:
      Issues: 17
      Story Points: 32 (24.4%)

   In QA:
      Issues: 6
      Story Points: 10 (7.6%)

   Completed:
      Issues: 25
      Story Points: 69 (52.7%)

------------------------------------------------------------
   TOTAL: 59 issues, 131 story points
============================================================

üìã DETAILED BREAKDOWN:

In Dev (11 issues, 20 points):
------------------------------------------------------------
   VER10-7561: 2 points - Edit Sub Item Resource Quantities...
   VER10-8336: 2 points (defaulted) - Managing Values for Estimator...
   VER10-8501: 5 points - Epic 9- Fallback Mech- Auto allocate...
   ...
```

**Output Format**:
```json
{
  "date": "2025-11-11",
  "sprint": "NH Sprint 31",
  "project": "VER10",
  "summary": {
    "totalIssues": 59,
    "totalStoryPoints": 131,
    "byStatus": {
      "inDev": { "count": 11, "points": 20 },
      "inReview": { "count": 17, "points": 32 },
      "inQA": { "count": 6, "points": 10 },
      "completed": { "count": 25, "points": 69 },
      "other": { "count": 0, "points": 0 }
    }
  },
  "details": {
    "inDev": [ ... ],
    "inReview": [ ... ],
    "inQA": [ ... ],
    "completed": [ ... ]
  }
}
```

**Use Cases**:
- Daily stand-up status overview
- Quick sprint health check
- Identifying workflow stage bottlenecks
- Tracking work distribution across statuses
- Sprint velocity analysis

---

#### 17. `generate-burndown-summary.js`

**NEW**: Analyzes sprint burndown with detailed scope change tracking to identify scope creep and mid-sprint additions.

**Features**:
- Tracks initial sprint scope vs. current scope
- Identifies all issues added mid-sprint with dates
- Detects story point increases and decreases
- Calculates scope increase percentage
- Time-based analysis comparing expected vs. actual progress
- Detailed issue listing with summaries, dates, and assignees
- Analyzes changelog to determine when issues were added to sprint
- Perfect for understanding why burndown charts show scope increases

**Usage**:
```bash
npm run burndown
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31'; // Update this in the script
```

**Output**: `reports/burndown-summary.json`

**Console Output Example**:
```
============================================================
üìä BURNDOWN & SCOPE SUMMARY
============================================================

üì¶ INITIAL SCOPE (at sprint start):
   Issues: 119
   Story Points: 244

‚ûï SCOPE ADDED (mid-sprint):
   Issues Added: 16
   Story Points Added: 25

   Detailed list of issues added mid-sprint:
   ----------------------------------------------------------------------
   KEY         | PTS | DATE       | TYPE   | STATUS      | SUMMARY
   ----------------------------------------------------------------------
   VER10-9165  |   1 | 2025-11-06 | Story  | In QA       | Configure NRVAT %
   VER10-9172  |   2 | 2025-11-06 | Bug    | Open        | Incorrect date handling
   VER10-9197  |   2 | 2025-11-10 | Bug    | In Dev      | External UAT issue
   ...

üìà STORY POINT INCREASES:
   Total Increases: 83.5 points
   Number of Changes: 56

   Story point increases:
   ‚Ä¢ VER10-8702: 1 ‚Üí 2 pts (+1) - 2025-11-06 - Funsho Sanni
   ‚Ä¢ VER10-8334: 1 ‚Üí 3 pts (+2) - 2025-11-06 - Funsho Sanni
   ...

üìä CURRENT STATUS:
   Total Sprint Scope: 352.5 points
   Completed: 0 points (0 issues)
   Remaining: 269 points (135 issues)
   Progress: 0%

‚ö†Ô∏è  SCOPE CHANGE IMPACT:
   Initial Sprint Scope: 244 points
   Scope Added Mid-Sprint: 108.5 points (+44%)
   Current Sprint Scope: 352.5 points

‚è∞ TIME-BASED ANALYSIS (57% through sprint):
   Expected Completed (if no scope change): 139 points
   Actual Completed: 0 points
   Variance: -139 points
```

**Output Format**:
```json
{
  "sprint": "NH Sprint 31",
  "sprintDetails": {
    "sprintId": 2897,
    "startDate": "2025-11-06T05:26:46.829Z",
    "endDate": "2025-11-20T12:30:00.000Z",
    "state": "active"
  },
  "scope": {
    "initial": 244,
    "added": 25,
    "increased": 83.5,
    "totalScope": 352.5,
    "completed": 0,
    "remaining": 269,
    "scopeIncreasePercentage": 44
  },
  "addedIssues": [
    {
      "key": "VER10-9165",
      "summary": "Configure NRVAT % i.e. Non Recoverable VAT -BE",
      "storyPoints": 1,
      "addedDate": "2025-11-06T15:30:00.000Z",
      "issueType": "Story",
      "status": "In QA",
      "created": "2025-11-06T10:00:00.000Z"
    }
  ],
  "storyPointIncreases": [
    {
      "key": "VER10-8702",
      "summary": "UI - (Admin) Manual assignment of Tags...",
      "from": 1,
      "to": 2,
      "increase": 1,
      "changedDate": "2025-11-06T12:00:00.000Z",
      "changedBy": "Funsho Sanni"
    }
  ],
  "timeAnalysis": {
    "percentThrough": 57,
    "expectedCompleted": 139,
    "actualCompleted": 0,
    "variance": -139
  }
}
```

**Use Cases**:
- Understanding scope creep in sprints
- Identifying when and why issues were added mid-sprint
- Tracking story point estimation changes
- Sprint retrospective analysis
- Explaining burndown chart anomalies
- Planning corrective actions for scope management
- Identifying patterns of mid-sprint additions

**Key Insights**:
- Shows exactly which issues were added after sprint start
- Tracks who added story points and when
- Calculates impact of scope changes on sprint velocity
- Helps distinguish between velocity issues and scope creep
- Provides evidence for sprint planning improvements

---

## Output Files

All generated files are saved in the `reports/` directory:

### JSON Files
- `completed-points-<start>-to-<end>.json` - Completed work in date range
- `sprint-estimates-<date>.json` - Sprint allocations from JIRA
- `moved-to-qa-<date>.json` - Issues entered QA today
- `moved-to-dev-<date>.json` - Issues entered Dev today
- `work-done-today-<date>.json` - Combined daily activity with sprint totals
- `dev-review-by-assignee.json` - Active Dev/Review work by assignee
- `assignee-report-sprint-<number>.json` - Assignee/team analysis
- `assignee-allocation-<date>.json` - Historical allocations
- `issues-in-qa-sprint-<number>.json` - Current QA backlog
- `time-in-status-sprint-<number>.json` - Stale issues analysis
- `points-by-status.json` - Story point distribution by workflow status
- `burndown-summary.json` - **NEW**: Sprint burndown with scope creep analysis

### PDF Files
- `sprint-<number>-report.pdf` - Sprint executive report
- `work-done-today-<date>.pdf` - Daily activity report
- `assignee-report-sprint-<number>.pdf` - Team/assignee report

### Excel Files
- `data/NH Story Point Plan.xlsx` - Updated with generated sprint sheets

---

## Common Workflows

### Daily Stand-up Report
```bash
# See what was worked on yesterday
npm run work-today

# Generate PDF for sharing
npm run work-today-pdf 2025-11-10
```

### Sprint Planning
```bash
# 1. Update main Excel plan with sprint dates and epic allocations
# 2. Generate sprint sheets
npm run generate-sheets

# 3. Generate sprint report
npm run generate-report 31
```

### Sprint Health Check
```bash
# Get status distribution overview
npm run points-by-status

# Analyze burndown and scope changes
npm run burndown

# Check current QA backlog
npm run issues-in-qa

# Identify blocked/stale issues
npm run time-in-status

# Review team allocation
npm run assignee-report
npm run assignee-pdf 31
```

### Release Reporting
```bash
# Generate sprint reports for all sprints in release
npm run generate-report 31
npm run generate-report 32
npm run generate-report 33

# Analyze team performance across sprints
npm run assignee-allocation
```

---

## Troubleshooting

### JIRA API Issues

**Problem**: `401 Unauthorized`
- **Solution**: Check that `JIRA_EMAIL` and `JIRA_API_TOKEN` are correctly set
- Verify the token hasn't expired at https://id.atlassian.com/manage-profile/security/api-tokens

**Problem**: `410 Gone` or `400 Bad Request`
- **Solution**: Scripts use a two-step API approach (fetch keys, then details) to avoid deprecated endpoints

**Problem**: Missing story points
- **Solution**: Scripts default Story and Bug types to 2 points if missing

### Excel File Issues

**Problem**: Formula values showing as `[object Object]`
- **Solution**: Scripts extract `.result` property from formula objects

**Problem**: Wrong epic totals
- **Solution**: Add `IGNORE BELOW` marker to exclude summary/scratch rows

**Problem**: Wrong dates in Progress sheet
- **Solution**: Ensure "Sprint Start Date" and "Sprint End Date" are formatted as dates in Excel

### PDF Generation Issues

**Problem**: Bars going off page
- **Solution**: Scripts auto-scale based on `maxBarWidth` constant

**Problem**: Overlapping text
- **Solution**: Adjust font sizes and spacing in `templates/report-template.js`

---

## Script Customization

### Changing Sprint Names
Update in each JIRA script:
```javascript
const CURRENT_SPRINT = 'NH Sprint 32'; // Change to your sprint name
```

### Changing Status Names
Update status arrays in JIRA scripts:
```javascript
const COMPLETED_STATUSES = ['Ready for release', 'CLOSED', 'Closed', 'Done'];
const IN_QA_STATUS = 'In QA';
const IN_DEV_STATUS = 'In Dev';
```

### Changing S-Curve Profile
Edit in `generate-sprint-sheets.js`:
```javascript
function generateSCurveProfile(totalDays) {
  const profile = [];
  for (let i = 0; i < totalDays; i++) {
    const t = i / (totalDays - 1);
    // Adjust these parameters to change curve shape
    const sigmoid = 1 / (1 + Math.exp(-10 * (t - 0.5)));
    profile.push(sigmoid);
  }
  return profile;
}
```

### Changing Story Point Defaults
Update in JIRA scripts:
```javascript
// Current default: 2 points for Stories/Bugs without points
if ((issueType === 'Story' || issueType === 'Bug') && storyPoints === 0) {
  storyPoints = 2; // Change this value
}
```

---

## NPM Scripts Reference

```json
{
  "generate-sheets": "node src/generate-sprint-sheets.js",
  "generate-report": "node src/generate-sprint-report.js",
  "jira-points": "node src/get-jira-completed-points.js",
  "sprint-estimates": "node src/generate-sprint-estimates.js",
  "jira-qa": "node src/generate-jira-into-QA.js",
  "jira-dev": "node src/generate-jira-into-dev.js",
  "work-today": "node src/generate-work-done-today-report.js",
  "work-today-pdf": "node src/generate-work-today-pdf.js",
  "assignee-report": "node src/generate-assignee-report.js",
  "assignee-pdf": "node src/generate-assignee-pdf.js",
  "assignee-allocation": "node src/generate-assignee-allocation-report.js",
  "issues-in-qa": "node src/generate-issues-currently-in-qa.js",
  "time-in-status": "node src/generate-time-in-status.js",
  "nh-defect-upload": "node src/nh-defect-upload.js",
  "dev-review": "node src/generate-dev-review-by-assignee.js",
  "points-by-status": "node src/generate-points-by-status.js",
  "complete-epics": "node src/generate-complete-epics.js",
  "design-progress": "node src/generate-design-progress.js",
  "design-pdf": "node src/generate-design-status-pdf.js",
  "burndown": "node src/generate-burndown-summary.js"
}
```

---

## Project Structure

```
plan-refactor/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ NH Story Point Plan.xlsx    # Main planning Excel file
‚îú‚îÄ‚îÄ reports/                         # Generated output files
‚îÇ   ‚îú‚îÄ‚îÄ *.json                      # JSON data files
‚îÇ   ‚îî‚îÄ‚îÄ *.pdf                       # PDF reports
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ generate-sprint-sheets.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-sprint-report.js
‚îÇ   ‚îú‚îÄ‚îÄ get-jira-completed-points.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-sprint-estimates.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-jira-into-QA.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-jira-into-dev.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-work-done-today-report.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-work-today-pdf.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-assignee-report.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-assignee-pdf.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-assignee-allocation-report.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-issues-currently-in-qa.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-time-in-status.js
‚îÇ   ‚îú‚îÄ‚îÄ nh-defect-upload.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-dev-review-by-assignee.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-points-by-status.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-complete-epics.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-design-progress.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-design-status-pdf.js
‚îÇ   ‚îú‚îÄ‚îÄ generate-burndown-summary.js
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îî‚îÄ‚îÄ report-template.js      # PDF layout definitions
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

---

## License

Internal use only. Proprietary software.

---

## Support

For issues or questions, contact the development team.

**Last Updated**: November 2025
