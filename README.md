# Sprint Management & JIRA Reporting Suite

A comprehensive Node.js toolkit for managing sprint planning, tracking story points, and generating detailed reports from both Excel plans and JIRA Cloud.

## Table of Contents

- [Overview](#overview)
- [Setup](#setup)
- [Configuration](#configuration)
- [Excel Plan Structure](#excel-plan-structure)
- [Scripts](#scripts)
  - [Sprint Planning Scripts](#sprint-planning-scripts)
  - [JIRA Integration Scripts](#jira-integration-scripts)
  - [Daily Reporting Scripts](#daily-reporting-scripts)
  - [Team Analysis Scripts](#team-analysis-scripts)
  - [Quality Assurance Scripts](#quality-assurance-scripts)
- [Output Files](#output-files)
- [Troubleshooting](#troubleshooting)

---

## Overview

This suite provides end-to-end sprint management capabilities:
- **Sprint Planning**: Generate sprint sheets with S-curve story point distribution
- **Progress Tracking**: Monitor daily velocity, cumulative progress, and burndown
- **JIRA Integration**: Pull live data on completed work, in-progress items, and team allocation
- **Team Analytics**: Analyze assignee workload, team performance, and capacity
- **Quality Monitoring**: Track QA backlog and identify stale issues
- **PDF Reports**: Professional PDF reports for executive stakeholders

---

## Setup

### Prerequisites
- Node.js (v14 or higher)
- npm or yarn
- JIRA Cloud account with API access
- Excel plan file (`.xlsx` format)

### Installation

```bash
npm install
```

### Dependencies
- `exceljs` - Excel file manipulation
- `pdfkit` - PDF generation
- `axios` - HTTP client for JIRA API
- `xlsx` - Excel file parsing

---

## Configuration

### Environment Variables

All JIRA integration scripts require these environment variables:

```bash
export JIRA_EMAIL="your.email@company.com"
export JIRA_API_TOKEN="your_jira_api_token"
export JIRA_BASE_URL="https://your-company.atlassian.net"
```

#### Obtaining a JIRA API Token

1. Log in to [https://id.atlassian.com/manage-profile/security/api-tokens](https://id.atlassian.com/manage-profile/security/api-tokens)
2. Click "Create API token"
3. Give it a descriptive name (e.g., "Sprint Reports")
4. Copy the token (you won't be able to see it again)
5. Set it as the `JIRA_API_TOKEN` environment variable

### Project Configuration

Update these constants in the respective scripts as needed:

**JIRA Settings** (in all JIRA scripts):
```javascript
const PROJECT_KEY = 'VER10';           // Your JIRA project key
const CURRENT_SPRINT = 'NH Sprint 31'; // Current sprint name
```

**Excel File Location**:
```javascript
const WORKBOOK_PATH = './data/NH Story Point Plan.xlsx';
```

---

## Excel Plan Structure

The main planning Excel file (`data/NH Story Point Plan.xlsx`) must have the following structure:

### Main Sheet: "Full-Delivery"

#### Required Rows (Column A):
- **Sprint Information Rows**:
  - `Sprint Number` - e.g., 30, 31, 32
  - `Sprint Start Date` - Working day start date
  - `Sprint End Date` - Working day end date
  - `Total Working Days Per Sprint` - Usually 10
  - `Total Committed Story Points Per Sprint` - Target points
  - `Story Points Delivered` - Actual delivered points (updated daily)
  - `BUGS` - Bug fix story points
  - `STABILIZATION` - Stabilization work points
  - `DELIVERED TODAY` - Points completed today (in Column B)
  - `TOTAL PROJECT REMAINING STORY POINTS` - Overall project remaining work

- **Epic Rows** (starting after header rows):
  - Column A: Epic name
  - Columns for each sprint: Story points allocated
  - Row named `TOTALS`: Formula summing all epics
  - Row marker: `IGNORE BELOW` - Anything below this is excluded

#### Special Markers:
- `IGNORE BELOW` - Place this in Column A to mark the end of epic data

### Progress Sheet

Auto-generated by scripts with the following structure:
- **Row 1**: Date headers (working days only)
- **Row 2**: Target Velocity (S-curve distributed)
- **Row 3**: Actual Velocity (daily completed points)
- **Row 4**: Cumulative Committed
- **Row 5**: Cumulative Actual
- **Row 6**: Variance (Actual - Committed)
- **Row 7**: Burndown (Remaining work)

### Designs Sheet (Optional)

For design progress tracking:
- **Column A**: Epic names
- **Column B**: Percentage complete (0-100)

### Individual Sprint Sheets

Auto-generated by `generate-sprint-sheets.js`:
- Sprint metadata (dates, working days, totals)
- Epic-by-epic breakdown
- Daily story point allocation (with S-curve distribution)
- Story Points Delivered row
- Summary calculations

---

## Scripts

### Sprint Planning Scripts

#### 1. `generate-sprint-sheets.js`

Generates individual sprint sheets from the main Excel plan.

**Features**:
- Reads sprint configuration from "Full-Delivery" sheet
- Distributes story points using S-curve profile (slow start, peak middle, slow end)
- Creates one sheet per sprint with detailed breakdown
- Excludes epics with 0 points for that sprint
- Respects "IGNORE BELOW" marker
- Populates Progress sheet with S-curve target velocity

**Usage**:
```bash
npm run generate-sheets
```

**S-Curve Distribution**:
- Days 1-2: ~15% of total (slow start)
- Days 3-7: ~40% of total (peak productivity)
- Days 8-10: ~15% of total (slow finish)

**Output**: Updates `data/NH Story Point Plan.xlsx` with:
- Individual sprint sheets (e.g., "Sprint 30", "Sprint 31")
- Updated "Progress" sheet with target velocities

---

#### 2. `generate-sprint-report.js`

Generates comprehensive PDF reports for sprints.

**Features**:
- **Page 1**: Simplified sprint status (committed vs. delivered, velocity metrics)
- **Page 2**: Detailed executive summary with insights and burndown
- **Design Pages**: Epic-level design progress (if Designs sheet exists)
- Charts: Horizontal stacked bar charts showing work breakdown (Features/Bugs/Stabilization)
- Project-level metrics: Overall progress, remaining work, required velocity
- Release-level metrics: Progress toward specific release milestones
- Visual indicators: Red/green status markers for at-risk metrics

**Usage**:
```bash
npm run generate-report <sprint-number>
```

**Example**:
```bash
npm run generate-report 31
```

**Output**: `reports/sprint-<number>-report.pdf`

---

### JIRA Integration Scripts

All JIRA scripts require environment variables to be set.

#### 3. `get-jira-completed-points.js`

Fetches completed story points from JIRA for a date range.

**Features**:
- Queries issues completed in a date range
- Uses "Status change to Done" date (transitions to 'READY FOR RELEASE' or 'CLOSED')
- Filters to Story and Bug issue types only
- Defaults missing story points to 2
- Provides breakdown by issue type

**Usage**:
```bash
npm run jira-points <start-date> <end-date>
```

**Example**:
```bash
npm run jira-points 2025-11-09 2025-11-10
```

**Output**: `reports/completed-points-<start>-to-<end>.json`

**Output Format**:
```json
{
  "dateRange": { "start": "2025-11-09", "end": "2025-11-10" },
  "summary": {
    "totalIssues": 15,
    "totalStoryPoints": 32,
    "byType": {
      "Story": { "count": 12, "storyPoints": 26 },
      "Bug": { "count": 3, "storyPoints": 6 }
    }
  },
  "issues": [...]
}
```

---

#### 4. `generate-sprint-estimates.js`

Gets total story points allocated to specific sprints in JIRA.

**Features**:
- Queries multiple sprints (NH Sprint 31 through NH Sprint 36)
- Counts Epic, Story, and Bug issue types only
- Defaults missing story points to 2 for Stories/Bugs
- Uses two-step API approach to handle pagination (fetch keys, then details)

**Usage**:
```bash
npm run sprint-estimates
```

**Output**: `reports/sprint-estimates-<date>.json`

**Output Format**:
```json
{
  "sprints": {
    "NH Sprint 31": {
      "totalStoryPoints": 250,
      "totalIssues": 125,
      "breakdown": {
        "Epic": { "count": 15, "storyPoints": 0 },
        "Story": { "count": 95, "storyPoints": 220 },
        "Bug": { "count": 15, "storyPoints": 30 }
      }
    }
  }
}
```

---

#### 5. `generate-jira-into-QA.js`

Lists issues moved to "In QA" status today.

**Features**:
- Analyzes changelog for status transitions today
- Includes issue details (key, summary, type, priority, points)
- Filters to Story and Bug types
- Defaults missing points to 2

**Usage**:
```bash
npm run jira-qa
```

**Output**: `reports/moved-to-qa-<date>.json`

---

#### 6. `generate-jira-into-dev.js`

Lists issues moved to "In Dev" status today.

**Features**:
- Analyzes changelog for status transitions today
- Includes issue details (key, summary, type, priority, points)
- Filters to Story and Bug types
- Defaults missing points to 2

**Usage**:
```bash
npm run jira-dev
```

**Output**: `reports/moved-to-dev-<date>.json`

---

### Daily Reporting Scripts

#### 7. `generate-work-done-today-report.js`

Combines completed work, QA entries, and dev starts into a single daily report.

**Features**:
- Aggregates data from completed, in-QA, and in-dev scripts
- Shows total story points worked on across all activities
- Optimized JQL queries (only fetches issues updated today)
- Detailed breakdown by activity type

**Usage**:
```bash
npm run work-today
```

**Output**: `reports/work-done-today-<date>.json`

**Output Format**:
```json
{
  "date": "2025-11-10",
  "summary": {
    "completed": { "issues": 8, "storyPoints": 18 },
    "movedToQA": { "issues": 5, "storyPoints": 10 },
    "movedToDev": { "issues": 4, "storyPoints": 8 },
    "totalStoryPointsWorked": 36
  },
  "details": { ... }
}
```

---

#### 8. `generate-work-today-pdf.js`

Generates PDF report from the daily work JSON.

**Features**:
- Professional multi-page PDF layout
- Summary metrics at the top
- Bar charts for visual analysis
- Detailed issue lists by activity type

**Usage**:
```bash
npm run work-today-pdf <date>
```

**Example**:
```bash
npm run work-today-pdf 2025-11-10
```

**Output**: `reports/work-done-today-<date>.pdf`

---

### Team Analysis Scripts

#### 9. `generate-assignee-report.js`

Analyzes work done today and current sprint workload by assignee and team.

**Features**:
- Today's activity breakdown by assignee
- Current sprint workload (active vs. completed) by assignee
- Team-level allocation and completion tracking
- Uses custom JIRA field "Team Name" (`customfield_12700`)
- Comprehensive issue counting

**Usage**:
```bash
npm run assignee-report
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31'; // Update this in the script
```

**Output**: `reports/assignee-report-sprint-<number>.json`

**Output Format**:
```json
{
  "sprint": "NH Sprint 31",
  "todayActivity": {
    "completed": { ... },
    "movedToQA": { ... },
    "movedToDev": { ... }
  },
  "sprintWorkload": {
    "byAssignee": { ... },
    "byTeam": {
      "Team 1": {
        "totalIssues": 50,
        "totalPoints": 100,
        "completedIssues": 25,
        "completedPoints": 50,
        "activeIssues": 20,
        "activePoints": 40,
        "percentComplete": 50
      }
    }
  }
}
```

---

#### 10. `generate-assignee-pdf.js`

Generates PDF report from assignee analysis.

**Features**:
- **Page 1**: Team allocation and progress (total, completed, active)
- **Page 2**: Individual assignee workload details
- Bar charts for visual analysis
- Condensed formatting to fit all data

**Usage**:
```bash
npm run assignee-pdf <sprint-number>
```

**Example**:
```bash
npm run assignee-pdf 31
```

**Output**: `reports/assignee-report-sprint-<number>.pdf`

---

#### 11. `generate-assignee-allocation-report.js`

Historical performance analysis across multiple sprints.

**Features**:
- Queries multiple sprints (configurable range)
- Per-assignee allocation vs. completion
- Aggregate totals across all sprints
- Detailed breakdown by sprint and assignee

**Usage**:
```bash
npm run assignee-allocation
```

**Configuration** (edit script):
```javascript
const SPRINTS = ['NH Sprint 28', 'NH Sprint 29', 'NH Sprint 30', 'NH Sprint 31'];
```

**Output**: `reports/assignee-allocation-<date>.json`

**Console Output**: Summary table showing:
- Issues allocated per assignee per sprint
- Story points allocated per assignee per sprint
- Totals across all sprints

---

### Quality Assurance Scripts

#### 12. `generate-issues-currently-in-qa.js`

Lists all issues currently in QA for the current sprint.

**Features**:
- Shows all Story and Bug issues in "In QA" status
- Includes story points (defaults to 2 if missing)
- Groups by assignee
- Shows issue keys, types, and summaries

**Usage**:
```bash
npm run issues-in-qa
```

**Output**: `reports/issues-in-qa-sprint-<number>.json`

**Console Output Example**:
```
ðŸ“Š Issues Currently in QA - Sprint 31

### Summary:
6 issues | 10 story points

### All Issues:
1. VER10-8503 - Story - 3 pts - Rachita Kanchari
2. VER10-8484 - Story - 3 pts - bhavesh budhrani
...

### By Assignee:
- Rachita Kanchari: 1 issue (3 pts)
- bhavesh budhrani: 1 issue (3 pts)
...
```

---

#### 13. `generate-time-in-status.js`

Identifies stale issues (no status change for 24+ hours).

**Features**:
- Analyzes changelog to determine last status change
- Sorts by longest time in status (most critical first)
- Excludes completed issues
- Groups by status and assignee
- Highlights workflow bottlenecks

**Usage**:
```bash
npm run time-in-status
```

**Configuration**:
```javascript
const CURRENT_SPRINT = 'NH Sprint 31';
const STALE_THRESHOLD_HOURS = 24;
```

**Output**: `reports/time-in-status-sprint-<number>.json`

**Console Output**:
- Total active issues vs. stale issues
- Top stale issues sorted by duration
- Breakdown by status (identifies bottlenecks)
- Breakdown by assignee (identifies blockers)

**Example Critical Findings**:
```
1. VER10-7735 - In Dev
   Time in Status: 112 days 20 hours
   Assignee: Vijay Mishra
   Type: Bug | Priority: P2 - High | Points: 1
```

---

## Output Files

All generated files are saved in the `reports/` directory:

### JSON Files
- `completed-points-<start>-to-<end>.json` - Completed work in date range
- `sprint-estimates-<date>.json` - Sprint allocations from JIRA
- `moved-to-qa-<date>.json` - Issues entered QA today
- `moved-to-dev-<date>.json` - Issues entered Dev today
- `work-done-today-<date>.json` - Combined daily activity
- `assignee-report-sprint-<number>.json` - Assignee/team analysis
- `assignee-allocation-<date>.json` - Historical allocations
- `issues-in-qa-sprint-<number>.json` - Current QA backlog
- `time-in-status-sprint-<number>.json` - Stale issues analysis

### PDF Files
- `sprint-<number>-report.pdf` - Sprint executive report
- `work-done-today-<date>.pdf` - Daily activity report
- `assignee-report-sprint-<number>.pdf` - Team/assignee report

### Excel Files
- `data/NH Story Point Plan.xlsx` - Updated with generated sprint sheets

---

## Common Workflows

### Daily Stand-up Report
```bash
# See what was worked on yesterday
npm run work-today

# Generate PDF for sharing
npm run work-today-pdf 2025-11-10
```

### Sprint Planning
```bash
# 1. Update main Excel plan with sprint dates and epic allocations
# 2. Generate sprint sheets
npm run generate-sheets

# 3. Generate sprint report
npm run generate-report 31
```

### Sprint Health Check
```bash
# Check current QA backlog
npm run issues-in-qa

# Identify blocked/stale issues
npm run time-in-status

# Review team allocation
npm run assignee-report
npm run assignee-pdf 31
```

### Release Reporting
```bash
# Generate sprint reports for all sprints in release
npm run generate-report 31
npm run generate-report 32
npm run generate-report 33

# Analyze team performance across sprints
npm run assignee-allocation
```

---

## Troubleshooting

### JIRA API Issues

**Problem**: `401 Unauthorized`
- **Solution**: Check that `JIRA_EMAIL` and `JIRA_API_TOKEN` are correctly set
- Verify the token hasn't expired at https://id.atlassian.com/manage-profile/security/api-tokens

**Problem**: `410 Gone` or `400 Bad Request`
- **Solution**: Scripts use a two-step API approach (fetch keys, then details) to avoid deprecated endpoints

**Problem**: Missing story points
- **Solution**: Scripts default Story and Bug types to 2 points if missing

### Excel File Issues

**Problem**: Formula values showing as `[object Object]`
- **Solution**: Scripts extract `.result` property from formula objects

**Problem**: Wrong epic totals
- **Solution**: Add `IGNORE BELOW` marker to exclude summary/scratch rows

**Problem**: Wrong dates in Progress sheet
- **Solution**: Ensure "Sprint Start Date" and "Sprint End Date" are formatted as dates in Excel

### PDF Generation Issues

**Problem**: Bars going off page
- **Solution**: Scripts auto-scale based on `maxBarWidth` constant

**Problem**: Overlapping text
- **Solution**: Adjust font sizes and spacing in `templates/report-template.js`

---

## Script Customization

### Changing Sprint Names
Update in each JIRA script:
```javascript
const CURRENT_SPRINT = 'NH Sprint 32'; // Change to your sprint name
```

### Changing Status Names
Update status arrays in JIRA scripts:
```javascript
const COMPLETED_STATUSES = ['Ready for release', 'CLOSED', 'Closed', 'Done'];
const IN_QA_STATUS = 'In QA';
const IN_DEV_STATUS = 'In Dev';
```

### Changing S-Curve Profile
Edit in `generate-sprint-sheets.js`:
```javascript
function generateSCurveProfile(totalDays) {
  const profile = [];
  for (let i = 0; i < totalDays; i++) {
    const t = i / (totalDays - 1);
    // Adjust these parameters to change curve shape
    const sigmoid = 1 / (1 + Math.exp(-10 * (t - 0.5)));
    profile.push(sigmoid);
  }
  return profile;
}
```

### Changing Story Point Defaults
Update in JIRA scripts:
```javascript
// Current default: 2 points for Stories/Bugs without points
if ((issueType === 'Story' || issueType === 'Bug') && storyPoints === 0) {
  storyPoints = 2; // Change this value
}
```

---

## NPM Scripts Reference

```json
{
  "generate-sheets": "node src/generate-sprint-sheets.js",
  "generate-report": "node src/generate-sprint-report.js",
  "jira-points": "node src/get-jira-completed-points.js",
  "sprint-estimates": "node src/generate-sprint-estimates.js",
  "jira-qa": "node src/generate-jira-into-QA.js",
  "jira-dev": "node src/generate-jira-into-dev.js",
  "work-today": "node src/generate-work-done-today-report.js",
  "work-today-pdf": "node src/generate-work-today-pdf.js",
  "assignee-report": "node src/generate-assignee-report.js",
  "assignee-pdf": "node src/generate-assignee-pdf.js",
  "assignee-allocation": "node src/generate-assignee-allocation-report.js",
  "issues-in-qa": "node src/generate-issues-currently-in-qa.js",
  "time-in-status": "node src/generate-time-in-status.js"
}
```

---

## Project Structure

```
plan-refactor/
â”œâ”€â”€ data/
â”‚   â””â”€â”€ NH Story Point Plan.xlsx    # Main planning Excel file
â”œâ”€â”€ reports/                         # Generated output files
â”‚   â”œâ”€â”€ *.json                      # JSON data files
â”‚   â””â”€â”€ *.pdf                       # PDF reports
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ generate-sprint-sheets.js
â”‚   â”œâ”€â”€ generate-sprint-report.js
â”‚   â”œâ”€â”€ get-jira-completed-points.js
â”‚   â”œâ”€â”€ generate-sprint-estimates.js
â”‚   â”œâ”€â”€ generate-jira-into-QA.js
â”‚   â”œâ”€â”€ generate-jira-into-dev.js
â”‚   â”œâ”€â”€ generate-work-done-today-report.js
â”‚   â”œâ”€â”€ generate-work-today-pdf.js
â”‚   â”œâ”€â”€ generate-assignee-report.js
â”‚   â”œâ”€â”€ generate-assignee-pdf.js
â”‚   â”œâ”€â”€ generate-assignee-allocation-report.js
â”‚   â”œâ”€â”€ generate-issues-currently-in-qa.js
â”‚   â”œâ”€â”€ generate-time-in-status.js
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ report-template.js      # PDF layout definitions
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## License

Internal use only. Proprietary software.

---

## Support

For issues or questions, contact the development team.

**Last Updated**: November 2025
